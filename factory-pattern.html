<!DOCTYPE html>
<html>
  <head>
    <title>Factory Pattern Example</title>
    <meta charset="UTF-8">
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">

<!-- Latest compiled and minified JavaScript -->
<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
<script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script> 
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/qunit/1.16.0/qunit.min.js"></script>
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/qunit/1.16.0/qunit.min.css" />
       <style>
           body {
               background-color: #566C7F;
           }
           .header.hero {
               background-color: #343D40;
               color: #566C7F;
           }
           h1 {
               font-family: "motor";
               font-size:3em;
               color:#9BC2E5;
           }
           .scroll-box {
                border: 1px solid #566C7F;
                height: 400px;
                overflow: auto;
               padding:10px;
               background-color:#566C7F;

            }
           div.item.well{
                background-color:#2B3640 !important;
                border: 1px solid #2B3640;
            }
           .header.hero p {
               color: #D1F3FF;
               text-align:justify;
               font-family: "expo-sans-pro",sans-serif;               
               font-weight:200;
           }
           .title {
               font-size: 1.15em;
               font-family: "expo-sans-pro",sans-serif;               
               font-weight:200;
               color: #ACD7FF;
           }
           .published {
               font-size: .825em;
               color: #81A1BF;
           }
           .footer-links {
               color:lightgrey;
               font-size:.750em;
           }
           .footer-links a, p a {
               color:#EDEDED;
           }

       </style>
       <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.1/angular.min.js"></script>
       <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment.min.js"></script>
       <script src="//use.typekit.net/roe8afx.js"></script>
       <script>try{Typekit.load();}catch(e){}</script>
  </head>
  <body>
  <div class="header hero">
 
          <div class="container-fluid">
            <div class="row">
              <div class="col-sm-6 col-sm-offset-3 text-center">
               <h1>JavaScript Factory-Pattern Demo</h1>
                  <p><i class="fa fa-fw fa-info-circle"></i>&nbsp;This demo was created to showcase the abilities of Eddie Prislac, polyglot code warrior and UI/UX designer. It's meant to show a usage example of the Factory design pattern (please 'view source' to examine the source code). What the script does is takes an array of objects and uses them to create form elements, then distribute them to their proper form. With a little tweaking, this script might also be useful in the creation of a JS-based CMS (for instance, one could expand the factory system to create all sorts of elements, not just form elements, and fill any page element by ID). It makes use of Bootstrap, TypeKit, and FontAwesome, and for shits-and-giggles, I wrote some unit tests in QUnit and threw them in here too, at the bottom.</p>
              </div>
            </div>
          </div>

  </div>
  <br />
  <div class="container-fluid">
      <div class="row">
          <div class="col-sm-6 col-sm-offset-3">
              <div class="well">
                 <h3>Login Form</h5>
                  <form id="form-items">
                    

                  </form>
              </div>
          </div>
      </div>
      <div class="row">
          <div class="col-sm-6 col-sm-offset-3">
              <div class="well">
               <h3>Registration Form</h5>
                <form id="form-items2">
                  

                </form>
              </div>
          </div>
      </div>
      

      <div class="row">
          <div class="col-sm-6 col-sm-offset-3">
              
                 
                 <br />
                  <div id="qunit"></div>
                  <div id="qunit-fixture"></div>
                      <br />
                       
          </div>
      </div>
       <div class="row">   
          <div class="col-sm-6 col-sm-offset-3">
              <div class="well">
                 <h3>Test Form</h5>
                 <p><i class="fa fa-fw fa-info-circle"></i>&nbsp;This form is for the unit tests.</p>
                <form id="test-form-items">
                  

                </form>
              
             </div>
          </div>
      </div>
      
      <div class="row">
          <div class="col-sm-6 col-sm-offset-3">
              <footer>
            <div class="row">
                <div class="col-md-6 col-md-offset-3 text-center">
                    <span class="footer-links">
                       
                        <a href="https://github.com/semperfried76/angular-inline-scroll-demo" target="_blank" rel="source">Source Code Here</a><br />
                        For more, visit my seldom-updated blog at: <a href="http://semperfried.com" target="_blank" rel="blog">semperfried.com</a>
                    </span><br />
                    
                </div>
            </div>
             
         </footer>
          </div>
      </div>
  </div>

  
  <script type="text/javascript">

  // Factory Pattern example
  // In this example, the form items are listed in a JSON object, 
  // then fed into the factory to generate the form.
  // This could be used to generate dynamic forms for use in a NoSQL-database backed solution,
  // where custom forms are built for custom data-types

  var formItems = [
    {
        name: "Email Address",
        id: "email",
        type: "text",
        formId: "form-items"
    },
    {
        name: "Password",
        id: "password",
        type: "password",
        formId: "form-items"
    },
    {
        name: "First Name",
        id: "fName",
        type: "text",
        formId: "form-items2"
    },
    {
        name: "Last Name",
        id: "lName",
        type: "text",
        formId: "form-items2"
    },
    {
        name: "Email Address",
        id: "email",
        type: "text",
        formId: "form-items2"
    },
    {
        name: "Password",
        id: "password",
        type: "password",
        formId: "form-items2"
    },
    {
        name: "Verify Password",
        id: "verifyPassword",
        type: "password",
        formId: "form-items2"
    },
    {
        name: "Log In",
        id: "submitLogin",
        type: "button",
        formId: "form-items"
    },
    {
        name: "Submit Registration",
        id: "submitReg",
        type: "button",
        formId: "form-items2"
    }
  ];

  // each type of element will need it's own method to be called by the factory, based on the 'type' property of items in 'formItems'
  function TextInput( options ) {
    this.name = options.name || '';
    this.id = options.id || '';
    this.type = options.type || 'text';
    this.formId = options.formId || '';
    var formGroup = document.createElement('div'),
        fgLabel = document.createElement('label'),
        formInput = document.createElement('input');
    fgLabel.innerText = this.name;
    formGroup.appendChild(fgLabel);
    formInput.setAttribute('type','text');
    formInput.id = this.id;
    formInput.className ='form-control';
    formGroup.className= 'form-group';
    formGroup.appendChild(formInput);
    return formGroup;

  }

  function PasswordInput( options ) {
    this.name = options.name || '';
    this.id = options.id || '';
    this.type = options.type || 'password';
    this.formId = options.formId || '';
    var formGroup = document.createElement('div'),
        fgLabel = document.createElement('label'),
        formInput = document.createElement('input');
    fgLabel.innerText = this.name;
    formGroup.appendChild(fgLabel);
    formInput.setAttribute('type',this.type);
    formInput.id = this.id;
    formInput.className = 'form-control';
    formGroup.className = 'form-group';
    formGroup.appendChild(formInput);
    return formGroup;
  }

  function SubmitButton( options ) {
    this.name = options.name || '';
    this.id = options.id || '';
    this.type = options.type || 'button';
    this.formId = options.formId || '';
    var formGroup = document.createElement('div'),
        formInput = document.createElement('button');
    formInput.setAttribute('type',this.type);
    formInput.id = this.id;
    formInput.innerText = this.name;
    formInput.className = 'btn btn-sm btn-primary pull-right';
    formGroup.className = 'form-group';
    formGroup.appendChild(formInput);
    formGroup.appendChild(document.createElement('br'));
    return formGroup;
  }

  // our actual factory method, it takes the formItem object passed to it and checks its type, generates the proper input/button, then inserts it into the proper form
  function formFactory( options ) {
    var returnedFormInput = {};
    var form = document.getElementById( options.formId );
    switch ( options.type ) {
        case 'text':
            returnedFormInput = new TextInput( options );
            break;
        case 'password':
            returnedFormInput = new PasswordInput( options );
            break;
        case 'button':
            returnedFormInput = new SubmitButton( options );
            break;
    }
    form.appendChild( returnedFormInput );
                
  }

  // feeds formItems to the 'formFactory' method
  function buildForm( myFormItems ){
    for ( var i=0; i < myFormItems.length; i++ ) {
      formFactory( myFormItems[i] );
    }
  }

  // give our generated buttons something to do
  // we set the event listener on document because listening for the click event on items that have not yet been created in the dom on page load will not work if we set it directly on the click event of 'button'
  $(document).on('click','button',function(){alert($(this).closest('form').attr('id') + ' form submitted!');});

  // call 'buildForm'
  buildForm( formItems );




///////////////////////////////////////////////////////////
  // unit tests
//////////////////////////////////////////////////////////
  // These tests will assert that the elements are being created within their proper container, and that an element with the proper tag-name and type has been generated using the 'formFactory' method
  QUnit.test('formFactory behavior', function( assert ) {
      // data for our unit tests
      var testFormItems = [{
        name: "Email Address",
        id: "testEmail",
        type: "text",
        formId: "test-form-items"
      },
      {
        name: "Password",
        id: "testPassword",
        type: "password",
        formId: "test-form-items"
      },
      {
        name: "Log In",
        id: "testSubmitLogin",
        type: "button",
        formId: "test-form-items"
      }];
      
      // grab the test form
      var testForm = document.getElementById('test-form-items');
      
      // nothing up muh sleeve... (no form elements in form)
      assert.equal( testForm.children.length, 0, "0 form elements before 'buildForm' is run" );
      
      buildForm( testFormItems );
      
      // presto! (form elements are generated)
      // test that there is a form element for every item in 'testFormElements
      assert.equal( testForm.children.length, testFormItems.length, "A form element has been created for each item in 'testFormElements' after 'buildForm is run" );
      
      // create variables for the generated elements
      var testEmail = document.getElementById('testEmail'),
          testPassword = document.getElementById('testPassword'),
          testSubmit = document.getElementById('testSubmitLogin') ;
      // test that the form elements have the proper tag names
      assert.equal( testEmail.tagName.toLowerCase(), 'input', "Generated Email field is an input" );
      assert.equal( testPassword.tagName.toLowerCase(), 'input', "Generated Password field is an input" );
      assert.equal( testSubmit.tagName.toLowerCase(), 'button', "Generated 'Log In' is a button" );
      
      // test that the form elements have the proper type
      assert.equal( testEmail.getAttribute('type'), 'text', "Generated Email field has type='text'" );
      assert.equal( testPassword.getAttribute('type'), 'password', "Generated Password field has type='password'" );
      assert.equal( testSubmit.getAttribute('type'), 'button', "Generated 'Log in' button has type='button'" );
      
      // test that the form elements were generated within the proper form by seeing if they are not 'undefined' when trying to find them within 'testForm', using jQuery's 'find' method
      assert.notEqual( $(testForm).find('#testEmail'),'undefined', "'#testEmail' was generated within '#testForm'");
      assert.notEqual( $(testForm).find('#testPassword'),'undefined', "'#testPassword' was generated within '#testForm'");
      assert.notEqual( $(testForm).find('#testSubmitLogin'),'undefined', "'#testSubmitLogin' was generated within '#testForm'");
  });
   

</script>
</body>
</html>